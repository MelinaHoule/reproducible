<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Clear erroneous archivist artifacts — clearStubArtifacts • reproducible</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">reproducible</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PredictiveEcology/reproducible">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Clear erroneous archivist artifacts</h1>
    </div>

    
    <p>Stub artifacts can result from several causes. The most common being
erroneous removal of a file in the sqlite database. This can be caused
sometimes if an archive object is being saved multiple times by multiple
threads. This function will clear entries in the sqlite database which
have no actual file with data.</p>
    

    <pre class="usage"><span class='fu'>clearStubArtifacts</span>(<span class='kw'>repoDir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='co'># S4 method for ANY</span>
<span class='fu'>clearStubArtifacts</span>(<span class='kw'>repoDir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>repoDir</th>
      <td><p>A character denoting an existing directory of the repository for
which metadata will be returned. If <code>NULL</code> (default), it will use the
<code>repoDir</code> specified in <code><a href='http://www.rdocumentation.org/packages/archivist/topics/setRepo'>archivist::setLocalRepo</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Invoked for its side effect on the <code>repoDir</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>tmpDir</span> <span class='kw'>&lt;-</span> <span class='fu'>file.path</span>(<span class='fu'>tempdir</span>(), <span class='st'>"reproducible_examples"</span>, <span class='st'>"clearStubArtifacts"</span>)

<span class='fu'>lapply</span>(<span class='fu'>c</span>(<span class='no'>runif</span>, <span class='no'>rnorm</span>), <span class='kw'>function</span>(<span class='no'>f</span>) {
  <span class='kw pkg'>reproducible</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/reproducible/topics/cache'>Cache</a></span>(<span class='no'>f</span>, <span class='fl'>10</span>, <span class='kw'>cacheRepo</span> <span class='kw'>=</span> <span class='no'>tmpDir</span>)
})</div><div class='output co'>#&gt; [[1]]
#&gt;  [1] 0.5907455 0.7917850 0.3346887 0.4321125 0.1253289 0.5792170 0.2656353
#&gt;  [8] 0.3847474 0.7882855 0.6997347
#&gt; attr(,"tags")
#&gt; [1] "cacheId:2bbb84ec118e7aaca79ce6eabdfa6f92"
#&gt; attr(,"call")
#&gt; [1] ""
#&gt; 
#&gt; [[2]]
#&gt;  [1] -0.97366532 -0.71016005  0.01809067 -1.44506438  0.93872973  0.03078885
#&gt;  [7]  0.86838197 -0.58685645 -0.22234218 -0.13920560
#&gt; attr(,"tags")
#&gt; [1] "cacheId:f955149ae1e51f7251308f1aa624e612"
#&gt; attr(,"call")
#&gt; [1] ""
#&gt; </div><div class='input'>
<span class='co'># clear out any stub artifacts</span>
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>)</div><div class='output co'>#&gt;                             artifact      tagKey
#&gt;  1: 6256d0e43e0b8490a2b36c6e7a4b69b8      format
#&gt;  2: 6256d0e43e0b8490a2b36c6e7a4b69b8        name
#&gt;  3: 6256d0e43e0b8490a2b36c6e7a4b69b8       class
#&gt;  4: 6256d0e43e0b8490a2b36c6e7a4b69b8        date
#&gt;  5: 6256d0e43e0b8490a2b36c6e7a4b69b8    function
#&gt;  6: 6256d0e43e0b8490a2b36c6e7a4b69b8 object.size
#&gt;  7: 6256d0e43e0b8490a2b36c6e7a4b69b8    accessed
#&gt;  8: 6256d0e43e0b8490a2b36c6e7a4b69b8     cacheId
#&gt;  9: e7eeecfcaae30139e1ebd76c20fdbea0      format
#&gt; 10: e7eeecfcaae30139e1ebd76c20fdbea0        name
#&gt; 11: e7eeecfcaae30139e1ebd76c20fdbea0       class
#&gt; 12: e7eeecfcaae30139e1ebd76c20fdbea0        date
#&gt; 13: e7eeecfcaae30139e1ebd76c20fdbea0    function
#&gt; 14: e7eeecfcaae30139e1ebd76c20fdbea0 object.size
#&gt; 15: e7eeecfcaae30139e1ebd76c20fdbea0    accessed
#&gt; 16: e7eeecfcaae30139e1ebd76c20fdbea0     cacheId
#&gt;                             tagValue         createdDate
#&gt;  1:                              rda 2017-09-05 16:33:32
#&gt;  2:                            Cache 2017-09-05 16:33:32
#&gt;  3:                          numeric 2017-09-05 16:33:32
#&gt;  4:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt;  5:                                f 2017-09-05 16:33:32
#&gt;  6:                              624 2017-09-05 16:33:32
#&gt;  7:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt;  8: 2bbb84ec118e7aaca79ce6eabdfa6f92 2017-09-05 16:33:32
#&gt;  9:                              rda 2017-09-05 16:33:32
#&gt; 10:                            Cache 2017-09-05 16:33:32
#&gt; 11:                          numeric 2017-09-05 16:33:32
#&gt; 12:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt; 13:                                f 2017-09-05 16:33:32
#&gt; 14:                              624 2017-09-05 16:33:32
#&gt; 15:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt; 16: f955149ae1e51f7251308f1aa624e612 2017-09-05 16:33:32</div><div class='input'>
<span class='no'>file2Remove</span> <span class='kw'>&lt;-</span> <span class='fu'>dir</span>(<span class='fu'>file.path</span>(<span class='no'>tmpDir</span>, <span class='st'>"gallery"</span>), <span class='kw'>full.name</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)[<span class='fl'>1</span>]
<span class='fu'>file.remove</span>(<span class='no'>file2Remove</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>) <span class='co'># repository directory still thinks files are there</span></div><div class='output co'>#&gt;                             artifact      tagKey
#&gt;  1: 6256d0e43e0b8490a2b36c6e7a4b69b8      format
#&gt;  2: 6256d0e43e0b8490a2b36c6e7a4b69b8        name
#&gt;  3: 6256d0e43e0b8490a2b36c6e7a4b69b8       class
#&gt;  4: 6256d0e43e0b8490a2b36c6e7a4b69b8        date
#&gt;  5: 6256d0e43e0b8490a2b36c6e7a4b69b8    function
#&gt;  6: 6256d0e43e0b8490a2b36c6e7a4b69b8 object.size
#&gt;  7: 6256d0e43e0b8490a2b36c6e7a4b69b8    accessed
#&gt;  8: 6256d0e43e0b8490a2b36c6e7a4b69b8     cacheId
#&gt;  9: e7eeecfcaae30139e1ebd76c20fdbea0      format
#&gt; 10: e7eeecfcaae30139e1ebd76c20fdbea0        name
#&gt; 11: e7eeecfcaae30139e1ebd76c20fdbea0       class
#&gt; 12: e7eeecfcaae30139e1ebd76c20fdbea0        date
#&gt; 13: e7eeecfcaae30139e1ebd76c20fdbea0    function
#&gt; 14: e7eeecfcaae30139e1ebd76c20fdbea0 object.size
#&gt; 15: e7eeecfcaae30139e1ebd76c20fdbea0    accessed
#&gt; 16: e7eeecfcaae30139e1ebd76c20fdbea0     cacheId
#&gt;                             tagValue         createdDate
#&gt;  1:                              rda 2017-09-05 16:33:32
#&gt;  2:                            Cache 2017-09-05 16:33:32
#&gt;  3:                          numeric 2017-09-05 16:33:32
#&gt;  4:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt;  5:                                f 2017-09-05 16:33:32
#&gt;  6:                              624 2017-09-05 16:33:32
#&gt;  7:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt;  8: 2bbb84ec118e7aaca79ce6eabdfa6f92 2017-09-05 16:33:32
#&gt;  9:                              rda 2017-09-05 16:33:32
#&gt; 10:                            Cache 2017-09-05 16:33:32
#&gt; 11:                          numeric 2017-09-05 16:33:32
#&gt; 12:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt; 13:                                f 2017-09-05 16:33:32
#&gt; 14:                              624 2017-09-05 16:33:32
#&gt; 15:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt; 16: f955149ae1e51f7251308f1aa624e612 2017-09-05 16:33:32</div><div class='input'>
<span class='co'># run clearStubArtifacts</span>
<span class='fu'>suppressWarnings</span>(<span class='fu'>clearStubArtifacts</span>(<span class='no'>tmpDir</span>))
<span class='fu'><a href='viewCache.html'>showCache</a></span>(<span class='no'>tmpDir</span>) <span class='co'># stubs are removed</span></div><div class='output co'>#&gt;                            artifact      tagKey
#&gt; 1: e7eeecfcaae30139e1ebd76c20fdbea0      format
#&gt; 2: e7eeecfcaae30139e1ebd76c20fdbea0        name
#&gt; 3: e7eeecfcaae30139e1ebd76c20fdbea0       class
#&gt; 4: e7eeecfcaae30139e1ebd76c20fdbea0        date
#&gt; 5: e7eeecfcaae30139e1ebd76c20fdbea0    function
#&gt; 6: e7eeecfcaae30139e1ebd76c20fdbea0 object.size
#&gt; 7: e7eeecfcaae30139e1ebd76c20fdbea0    accessed
#&gt; 8: e7eeecfcaae30139e1ebd76c20fdbea0     cacheId
#&gt;                            tagValue         createdDate
#&gt; 1:                              rda 2017-09-05 16:33:32
#&gt; 2:                            Cache 2017-09-05 16:33:32
#&gt; 3:                          numeric 2017-09-05 16:33:32
#&gt; 4:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt; 5:                                f 2017-09-05 16:33:32
#&gt; 6:                              624 2017-09-05 16:33:32
#&gt; 7:              2017-09-05 16:33:32 2017-09-05 16:33:32
#&gt; 8: f955149ae1e51f7251308f1aa624e612 2017-09-05 16:33:32</div><div class='input'>
<span class='co'># cleanup</span>
<span class='fu'><a href='viewCache.html'>clearCache</a></span>(<span class='no'>tmpDir</span>)
<span class='fu'>unlink</span>(<span class='no'>tmpDir</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Eliot McIntire

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Eliot J B McIntire, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
